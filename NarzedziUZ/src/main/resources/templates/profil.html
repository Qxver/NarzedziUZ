<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title th:text="${pageTitle}">Profil Klienta - Sklep z Narzędziami</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link th:href="@{/css/profil.css}" rel="stylesheet">
</head>
<body>
<div class="navbar">
  <div class="logo">
    <a href="/">NarzedziUZ</a>
  </div>

  <div class="search-bar">
    <input type="text" placeholder="Search for products...">
    <select>
      <option value="">Filter</option>
      <option value="filter1">By price (descending)</option>
      <option value="filter2">By price (ascending)</option>
      <option value="filter3">By rating (descending)</option>
      <option value="filter4">By rating (ascending)</option>
    </select>

    <select>
      <option value="">All Categories</option>
      <option value="category1">Category1</option>
      <option value="category2">Category2</option>
      <option value="category3">Category3</option>
    </select>
    <button class="search-button">Search</button>
  </div>
    <div class="navbar-buttons">
        <a href="/cart" class="navbar-button">Cart</a>

        <a th:if="${session.user != null}" th:href="@{/user/profile}" class="navbar-button" th:text="${session.userName}">User</a>
    </div>
</div>

<div class="profile-wrapper">
  <div class="profile-container">
    <div class="profile-buttons">
      <div>
      <a th:if="${session.user != null}" th:href="@{/login}" class="profile-button">Admin Panel</a>
      </div>
      <div>
      <a th:if="${session.user != null}" th:href="@{/login}" class="profile-button">Log Out</a>
      </div>
    </div>
    <div class="profile-header">
      <h1 class="profile-title" th:id="'pageTitle'" th:text="${pageTitle}">My Profile</h1>
      <p class="welcome-text" th:id="'welcomeMessage'" th:text="${welcomeMessage}">Welcome Back</p>
      <div class="profile-avatar" th:id="'avatar'" th:text="${initials}">JK</div>
      <div class="profile-info">
        <div class="info-item">
          <div class="info-label">Purchases</div>
          <div class="info-value" th:id="'totalPurchases'" th:text="${totalPurchases}">12</div>
        </div>
        <div class="info-item">
          <div class="info-label">Spent</div>
          <div class="info-value" th:id="'totalSpent'" th:text="${totalSpent} + ' zł'">3 450 zł</div>
        </div>
        <div class="info-item">
          <div class="info-label">Ratings</div>
          <div class="info-value" th:id="'totalRatings'" th:text="${totalRatings}">8</div>
        </div>
      </div>
    </div>

    <div class="profile-content">
      <div class="section">
        <h2 class="section-title" th:id="'purchaseHistoryTitle'" th:text="${purchaseHistoryTitle}">Purchase History</h2>
        <div th:id="'purchasesList'">
          <div th:each="purchase : ${purchases}" class="purchase-card" th:id="'purchase-'+${purchase.id}">
            <div class="purchase-header">
              <div class="purchase-date" th:text="${purchase.formattedDate}">15 grudnia 2024</div>
              <div class="purchase-status" th:text="${purchase.status}">Dostarczone</div>
            </div>
            <div class="purchase-items">
              <div th:each="item : ${purchase.items}" class="purchase-item">
                <span class="item-name" th:text="${item.productName}">Wiertarka</span>
                <span class="item-price" th:text="${item.price}">899 zł</span>
              </div>
            </div>
            <div class="purchase-total">
              <span class="total-label">Suma:</span>
              <span class="total-amount" th:text="${purchase.total}">988 zł</span>
            </div>
          </div>
          <div th:if="${purchases.isEmpty()}" class="no-data">Brak zakupów</div>
        </div>
      </div>

      <div class="section">
        <h2 class="section-title" th:id="'ratingsTitle'" th:text="${ratingsTitle}">Your Ratings</h2>
        <div th:id="'ratingsList'">
          <div th:each="rating : ${ratings}" class="rating-card">
            <div class="rating-header">
              <span class="product-name" th:text="${rating.productName}">Wiertarka Bosch</span>
              <div class="stars" th:data-rating="${rating.stars}">
                                    <span th:each="i : ${#numbers.sequence(1,5)}"
                                          th:class="${i <= rating.stars} ? 'star filled' : 'star'"
                                          th:text="${i <= rating.stars} ? '⭐' : '☆'">⭐</span>
              </div>
            </div>
            <div class="rating-comment" th:text="${rating.comment}">Świetny produkt!</div>
            <div class="rating-date" th:text="${'Oceniono: ' + rating.formattedDate}">Oceniono: 18 grudnia 2024</div>
          </div>
          <div th:if="${ratings.isEmpty()}" class="no-data">Brak ocen</div>
        </div>

      </div>
    </div>
  </div>
</div>

<script th:src="@{/js/profil.js}"></script>
<script th:inline="javascript">
  /*<![CDATA[*/
  window.userConfig = /*[[${userConfig}]]*/ {};
  window.currentUser = /*[[${user}]]*/ {};
  /*]]>*/
</script>
</body>
</html>
